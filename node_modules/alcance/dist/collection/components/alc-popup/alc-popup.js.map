{"version":3,"file":"alc-popup.js","sourceRoot":"","sources":["../../../../src/components/alc-popup/alc-popup.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Component, Host, h, Prop, Watch } from '@stencil/core';\nimport { computePosition, flip, shift, autoUpdate, size, offset, arrow } from '@floating-ui/dom';\n\nexport type PopupPlacement =\n  'top'\n  | 'top-start'\n  | 'top-end'\n  | 'bottom'\n  | 'bottom-start'\n  | 'bottom-end'\n  | 'right'\n  | 'right-start'\n  | 'right-end'\n  | 'left'\n  | 'left-start'\n  | 'left-end';\n\n/**\n * @slot DEFAULT - Slot para o elemento principal do popup.\n *\n * @slot anchor - Slot que serve como âncora e aciona a abertura do popup.\n*/\n\n@Component({\n  tag: 'alc-popup',\n  styleUrl: 'alc-popup.css',\n  shadow: false,\n})\nexport class AlcPopup {\n  private popupEl: HTMLElement;\n  private anchorEl: HTMLElement;\n  private cleanup: ReturnType<typeof autoUpdate> | undefined;\n  private padding = 8;\n  private arrowEl: HTMLElement;\n\n  /**\n  * Aciona a abertura do popup.\n  */\n  @Prop({ reflect: true, mutable: true }) active: boolean = false;\n\n  /**\n  * Define o posicionamento do popup.\n  */\n  @Prop({ reflect: true }) placement: PopupPlacement = 'bottom';\n\n  /**\n  * Quando definido como `true`, troca o posicionamento (placement) do popup para mantê-lo visível.\n  */\n  @Prop({ reflect: true }) flip: boolean = false;\n\n  /**\n  * Quando definido como `true`, desloca o popup ao longo do eixo para mantê-lo visível quando cortado.\n  */\n  @Prop({ reflect: true }) shift: boolean = false;\n\n  /**\n  * Determina como o pop-up é posicionado. A estratégia `absoluta` funciona bem na maioria dos casos.\n  * Se o overflow cortar o popup, usar a posição `fixed` muitas vezes pode contornar isso.\n  */\n  @Prop({ reflect: true }) strategy: 'absolute' | 'fixed' = 'absolute';\n\n  /**\n  * Define a distância entre o popup e âncora.\n  */\n  @Prop({ reflect: true }) distance: number = 0;\n\n  /** Syncs the popup's width or height to that of the anchor element. */\n  @Prop({ reflect: true }) sync: 'width' | 'height' | 'both' = null;\n\n  /**\n  *  Adiciona arrow no popup.\n  */\n  @Prop({ reflect: true }) arrow: boolean = false;\n\n  @Watch('active')\n  watchActive(newValue: boolean) {\n    if (newValue) {\n      // Ao ativar, start;\n      this.start();\n    }\n    else {\n      // Ao desativar, cleanup\n      if (this.cleanup) {\n        this.cleanup();\n      }\n    }\n  }\n\n  componentDidLoad() {\n    if (this.active) {\n      this.start();\n    }\n  }\n\n  disconnectedCallback() {\n    if (this.cleanup) {\n      this.cleanup();\n    }\n  }\n\n  start() {\n    if (!this.anchorEl || !this.popupEl) {\n      return;\n    }\n\n    // autoUpdate retorna uma função para limpar os event listeners\n    this.cleanup = autoUpdate(this.anchorEl, this.popupEl, () => {\n      this.reposition();\n    });\n  }\n\n  reposition() {\n    const middleware = this.resolveMiddleware();\n\n    computePosition(this.anchorEl, this.popupEl, {\n      placement: this.placement,\n      middleware,\n      strategy: this.strategy,\n    }).then(({ x, y, middlewareData, placement }) => {\n      // Descobri que aqui da para colocar o 'transform: translate()';\n      Object.assign(this.popupEl.style, {\n        left: `${x}px`,\n        top: `${y}px`,\n      });\n\n      const staticSide = { top: 'bottom', right: 'left', bottom: 'top', left: 'right' }[placement.split('-')[0]]!;\n\n      if (middlewareData.arrow) {\n        const {x, y, centerOffset} = middlewareData.arrow;\n        const rotate = { top: 225, right: 315, bottom: 45, left: 135 };\n\n        let top = '';\n        let left = '';\n        \n        const incValue = Math.sign(centerOffset) * -3;\n\n        if (placement === 'bottom' || placement === 'top') {\n          left = `${x + incValue}px`\n        } else {\n          top = `${y + incValue}px`\n        }\n\n        // Reseta os valores de top e bottom antes de atribuir o valor a um deles, se não fica os dois valores e buga a posição do arrow.\n        Object.assign(this.arrowEl.style, {\n          bottom: '',\n          right: '',\n          top,\n          left,\n          [staticSide]: `${-this.arrowEl.offsetWidth/2}px`,\n          transform: `rotate(${rotate[staticSide]}deg)`\n        });\n      }\n\n    });\n  }\n\n  resolveMiddleware(): Array<any> {\n    const padding = this.padding;\n\n    const middleware = [\n      offset({ mainAxis: this.distance })\n    ];\n\n    // Aqui temos as funções prontas do floating-ui mas podemos customizar e/ou criar se for necessário.\n    if (this.flip) {\n      middleware.push(\n        flip({\n          padding: padding,\n        })\n      )\n    }\n\n    // middleware.push(\n    //   size({\n    //     apply({rects, availableWidth, availableHeight, elements}) {\n    //       Object.assign(elements.floating.style, {\n    //         maxWidth: `${availableWidth - padding}px`,\n    //         maxHeight: `${availableHeight - padding}px`,\n    //         width: `${rects.reference.width}px`,\n    //       });\n    //     },\n    //   }),\n    // );\n\n\n    middleware.push(\n      size({\n        apply: ({rects, availableWidth, availableHeight, elements}) => {\n\n          if (this.sync) {\n            const syncWidth = this.sync === 'width' || this.sync === 'both';\n            const syncHeight = this.sync === 'height' || this.sync === 'both';\n\n            Object.assign(elements.floating.style, {\n              width: syncWidth ? `${rects.reference.width}px` : '',\n              height: syncHeight ? `${rects.reference.width}px` : '',\n            });\n\n          } else {\n            Object.assign(elements.floating.style, {\n              width: '',\n              height: '',\n            });\n          }\n          \n          // Object.assign(elements.floating.style, {\n          //   maxWidth: `${availableWidth - padding}px`,\n          //   maxHeight: `${availableHeight - padding}px`,\n          // });\n          \n        }\n      })\n    );\n\n\n    if (this.shift) {\n      middleware.push(shift({padding: padding}))\n    }\n\n    if (this.arrow) {\n      middleware.push(arrow({element: this.arrowEl}))\n    }\n\n    return middleware;\n  }\n\n\n  render() {\n    return (\n      <Host>\n        <div ref={(el: HTMLElement) => this.anchorEl = el}>\n          <slot name=\"anchor\"></slot>\n        </div>\n        <div\n          class={{\n            'alc-popup__content': true,\n            'alc-popup__content--active': this.active,\n            'alc-popup__content--fixed': this.strategy === 'fixed',\n          }}\n          ref={(el: HTMLElement) => this.popupEl = el}\n        >\n          <slot></slot>\n          <div ref={(el: HTMLElement) => this.arrowEl = el} class={this.arrow ? 'alc-popup__arrow' : ''}></div>\n        </div>\n      </Host>\n    );\n  }\n}\n\n"]}