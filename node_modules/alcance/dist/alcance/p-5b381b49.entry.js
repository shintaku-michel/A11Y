import{r as e,c as t,h as i,H as o,g as a}from"./p-BuFKlV49.js";import{g as s}from"./p-BY09qPiz.js";import{t as r}from"./p-oYUCam0b.js";const l='[data-alc-theme="light"] alc-autocomplete{--bg-color:var(--alc-color-surface-primary);--bg-color-footer:var(--alc-color-layer-b);--bg-color-hover:var(--alc-color-layer-b);--border-color:var(--alc-color-neutral-60);--border-color-hover:var(--alc-color-action-60);--border-color-focus:var(--alc-color-action-20);--text-color:var(--alc-color-text-primary)}[data-alc-theme="dark"] alc-autocomplete{--bg-color:var(--alc-color-surface-primary);--bg-color-footer:var(--alc-color-layer-b);--bg-color-hover:var(--alc-color-layer-b);--border-color:var(--alc-color-neutral-60);--border-color-hover:var(--alc-color-action-60);--border-color-focus:var(--alc-color-action-20);--text-color:var(--alc-color-text-primary)}alc-autocomplete{display:block}.alc-autocomplete__grid.is-hidden{display:none}.alc-autocomplete__result-cell{line-height:1.5rem}.alc-autocomplete__grid{z-index:10;width:100%;min-width:16rem;border-width:1px;border-style:solid;border-color:var(--border-color);background-color:var(--bg-color);padding:0px}.alc-autocomplete__message-row-container{width:100%}.alc-autocomplete__result-row{display:-ms-flexbox;display:flex;cursor:default;padding:0.5rem}.alc-autocomplete__result-row:hover{background-color:var(--bg--color-hover);background-color:var(--bg-color-hover)}.alc-autocomplete__result-row.is-focused{border-radius:0.125rem;border-width:2px;border-style:solid;border-color:var(--border-color-hover);color:var(--text-color);-webkit-text-decoration-line:underline;text-decoration-line:underline}.alc-autocomplete__result-cell.is-focused{-webkit-text-decoration-line:underline;text-decoration-line:underline}.alc-autocomplete__result-cell{margin:0px;display:inline-block;cursor:default;padding-left:0.25rem;padding-right:0.25rem;font-size:1rem;line-height:1.5rem}.alc-autocomplete__result-cell:nth-child(n+2){font-size:0.75rem;font-weight:400;line-height:1.5rem;color:var(--text-color)}.alc-autocomplete__icon{pointer-events:none;position:absolute;left:0.5rem;top:0.5rem}.alc-field__input.alc-autocomplete__input{padding-left:2rem}.alc-autocomplete__clear-button{position:absolute;right:0.25rem;cursor:pointer}.alc-autocomplete__message-row{border-left-width:1px;border-right-width:1px;border-bottom-width:1px;border-style:solid;border-color:var(--border-color);background-color:var(--bg-color-footer);padding:0.5rem;font-style:italic;color:var(--text-color)}.alc-autocomplete__field .alc-field__core{position:relative}.alc-field__input.alc-autocomplete__input{text-overflow:ellipsis;padding-left:2rem;padding-right:3rem}.alc-autocomplete__result-row--horizontal{-ms-flex-direction:row;flex-direction:row}.alc-autocomplete__result-row--vertical{-ms-flex-direction:column;flex-direction:column}.alc-autocomplete__grid--vertical{max-height:100%;overflow-y:scroll}.alc-autocomplete__list-container{position:absolute;z-index:10;margin-top:2.75rem;width:100%;min-width:250px}.alc-autocomplete__has-an-error-indicator,.alc-autocomplete__loading-indicator{margin-bottom:-0.25rem;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;border-width:1px;border-style:solid;border-color:var(--border-color);background-color:var(--bg-color-footer);padding:0.5rem;font-family:#000}.alc-autocomplete__loading-icon{margin-right:0.25rem}@-webkit-keyframes spin{to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spin{to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}.alc-autocomplete__loading-icon{-webkit-animation:spin 1s linear infinite;animation:spin 1s linear infinite}.alc-autocomplete__loading-icon .icon-inner{display:block}.alc-autocomplete__loading-icon .alc-icon__image{top:0px;margin-top:0px;height:auto;width:auto}.alc-autocomplete__container-results{height:100%;max-height:inherit}.alc-autocomplete__results{display:-ms-flexbox;display:flex;height:100%;max-height:inherit;-ms-flex-direction:column;flex-direction:column}';const c=class{constructor(i){e(this,i);this.alcChange=t(this,"alc-change",7);this.items=[];this.displayKeys="";this.label="";this.hint="";this.required=false;this.listDirection="vertical";this.disabled=false;this.loading=false;this.error=false;this.errorMsg=null;this.filteredData=[];this.itemSelected=false;this.selectedItemValue=null;this.emptyResult=false;this.activeRowIndex=-1;this.activeColIndex=0;this.rowsCount=0;this.colsCount=0;this.gridFocused=false;this.shown=false;this.selectionCol=0}selectedItemValueChanged(e){this.alcChange.emit(e)}handleLoadingChange(e,t){if(t===true&&e===false&&!this.disabled&&this.input){requestAnimationFrame((()=>{this.input.focus()}))}}componentWillLoad(){this.inputId=s();this.gridId=s();this.labelId=s();this.messageRowContainerId=s()}componentDidLoad(){const e=new MutationObserver((()=>{if(!this.input.hasAttribute("disabled")){if(this.disabled||this.loading){this.input.setAttribute("disabled","true")}}}));e.observe(this.input,{attributes:true,attributeFilter:["disabled"]});if(this.disabled||this.loading){this.input.setAttribute("disabled","true")}this.input.addEventListener("focus",this.handleFocus.bind(this))}handleBodyClick(e){const t=e.target;if(t===this.input||t instanceof Node&&this.grid.contains(t)){return}this.hideResults()}handleInputKeyUp(e){const t=e.target;if(!(t instanceof Node)||!this.input.contains(t)){return}const i=e.key;switch(i){case"ArrowUp":case"ArrowDown":case"Escape":case"Enter":e.preventDefault();return;case"ArrowLeft":case"ArrowRight":if(this.gridFocused){e.preventDefault();return}break;default:this.updateResults()}}handleInputKeyDown(e){const t=e.key;let i=this.activeRowIndex;let o=this.activeColIndex;const a=e.target;if(!(a instanceof Node)||!this.input.contains(a)){return}if(t==="Escape"){e.preventDefault();if(this.gridFocused){this.gridFocused=false;this.removeFocusCell(this.activeRowIndex,this.activeColIndex);this.activeRowIndex=-1;this.activeColIndex=0;this.input.setAttribute("aria-activedescendant","")}else{if(!this.shown){setTimeout((()=>{this.input.value=""}),1)}}if(this.shown){this.hideResults()}this.itemSelected=false;this.emptyResult=false;this.error=false;return}if(this.rowsCount<1){return}const s=this.getItemAt(i,this.selectionCol);let r;switch(t){case"ArrowUp":this.gridFocused=true;i=this.getRowIndex("ArrowUp");e.preventDefault();break;case"ArrowDown":this.gridFocused=true;i=this.getRowIndex("ArrowDown");e.preventDefault();break;case"ArrowLeft":if(o<=0){o=this.colsCount-1;i=this.getRowIndex("ArrowLeft")}else{o--}if(this.gridFocused){e.preventDefault()}break;case"ArrowRight":if(o===-1||o>=this.colsCount-1){o=0;i=this.getRowIndex("ArrowRight")}else{o++}if(this.gridFocused){e.preventDefault()}break;case"Enter":e.preventDefault();if(this.gridFocused){r=this.getItemAt(i,this.selectionCol);this.selectItem(r,e);this.gridFocused=false}else{this.hideResults()}return;case"Tab":this.hideResults();return;default:return}if(s){this.removeFocusCell(this.activeRowIndex,this.activeColIndex)}r=this.getItemAt(i,o);this.activeRowIndex=i;this.activeColIndex=o;if(r){this.input.setAttribute("aria-activedescendant","result-item-"+i+"x"+o);this.focusCell(i,o)}else{this.input.setAttribute("aria-activedescendant","")}}handleGridClick(e){const t=e.target;if(!t||!this.grid.contains(t)){return}let i=t.closest("li");if(!i){return}const o=i.querySelector(".alc-autocomplete__result-cell");this.selectItem(o,e)}isElementInView(e){const t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)}updateResults(){const e=this.input.value;this.emptyResult=false;if(e.length<2){this.hideResults();this.emptyResult=false;return}this.filteredData=this.searchDataService(e);this.hideResults();if(this.filteredData.length>0){const e=10;const t=this.filteredData.slice(0,e);if(t.length){for(let e=0;e<t.length;e++){const i=document.createElement("li");i.className=`alc-autocomplete__result-row alc-autocomplete__result-row--${this.listDirection}`;i.setAttribute("role","option");i.setAttribute("id","result-row-"+e);i.setAttribute("data-index",e.toString());this.displayKeys.split(",").forEach(((o,a)=>{const s=document.createElement("span");s.className="alc-autocomplete__result-cell";s.setAttribute("role","presentation");s.setAttribute("id","result-item-"+e+"x"+a);s.innerText=t[e][o.trim()];i.appendChild(s)}));this.grid.appendChild(i)}this.grid.classList.remove("is-hidden");this.input.setAttribute("aria-expanded","true");this.rowsCount=t.length;this.colsCount=this.displayKeys.split(",").length;this.shown=true}if(this.filteredData.length>e){this.showMessageRow("Mais de 10 itens encontrados. Refine seus critérios de pesquisa.")}}else{this.emptyResult=true}}getRowIndex(e){let t=this.activeRowIndex;switch(e){case"ArrowUp":case"ArrowLeft":if(t<=0){t=this.rowsCount-1}else{t--}break;case"ArrowDown":case"ArrowRight":if(t===-1||t>=this.rowsCount-1){t=0}else{t++}}return t}getItemAt(e,t){return document.getElementById("result-item-"+e+"x"+t)}selectItem(e,t){if(t)t.preventDefault();if(e){const t=e.closest("li");const i=t===null||t===void 0?void 0:t.getAttribute("data-index");if(i!==null&&i!==undefined){const t=this.filteredData[parseInt(i,10)];this.input.value=e.innerText;this.selectedItemValue=t;this.hideResults();this.input.setAttribute("aria-expanded","false");this.itemSelected=true;this.emptyResult=false;this.input.focus()}}}handleInput(){var e;this.itemSelected=((e=this.input)===null||e===void 0?void 0:e.value.length)>0}handleFocus(){const e=this.input.value||"";if(e.length>=2){this.updateResults()}}clearSelection(e){e.preventDefault();this.clearSelected();this.input.focus()}hideResults(){if(!this.shown){return}this.gridFocused=false;this.shown=false;this.activeRowIndex=-1;this.activeColIndex=0;this.grid.innerHTML="";this.grid.classList.add("is-hidden");this.input.setAttribute("aria-expanded","false");this.rowsCount=0;this.colsCount=0;this.input.setAttribute("aria-activedescendant","");const e=this.el.querySelector(`#${this.messageRowContainerId}`);if(e){e.innerHTML=""}if(!this.isElementInView(this.input)){this.input.scrollIntoView({behavior:"smooth",block:"nearest"})}}removeFocusCell(e,t){const i=document.getElementById("result-row-"+e);if(i){i.classList.remove("is-focused");i.ariaSelected="false"}const o=this.getItemAt(e,t);if(o)o.classList.remove("is-focused")}focusCell(e,t){const i=document.getElementById("result-row-"+e);if(i){i.classList.add("is-focused");i.ariaSelected="true"}const o=this.getItemAt(e,t);if(o){o.classList.add("is-focused");if(this.listDirection==="vertical"){this.ensureCellInView(o)}else{if(!this.isElementInView(o)){o.scrollIntoView({behavior:"smooth",block:"nearest"})}}}}ensureCellInView(e){const t=this.grid;const i=e.offsetTop;t.scrollTop=i}searchDataService(e){const t=e=>e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase();const i=t(e);const o=[];for(const e of this.items){for(const a of this.displayKeys.split(",")){const s=t(e[a.trim()]||"");if(s.includes(i)){o.push(e);break}}}return o}showMessageRow(e){const t=this.el.querySelector(`#${this.messageRowContainerId} `);const i=t.querySelector(".alc-autocomplete__message-row");if(!i){const i=document.createElement("div");i.className=`alc-autocomplete__message-row`;i.innerText=e;if(t){t.appendChild(i)}}}async getSelected(){return this.selectedItemValue||null}async setSelected(e){if(e){this.selectedItemValue=e;const t=this.displayKeys.split(",")[0].trim();const i=e[t];this.input.value=i;this.itemSelected=true;this.emptyResult=false}}async clearSelected(){this.input.value="";this.selectedItemValue=null;this.itemSelected=false;this.hideResults();this.emptyResult=false;this.error=false}render(){var e;const t=this.listDirection==="vertical"?"alc-autocomplete__grid alc-autocomplete__grid--vertical is-hidden alc-field__text":"alc-autocomplete__grid is-hidden alc-field__text";const a=this.shown||this.loading||this.error||!this.error&&this.emptyResult;return i(o,{key:"d05e40ab10e25b249643fd2a7533183d38a484e2"},i("alc-field",{key:"afbffba276a97c5e4113615196aa94358af8ddbd",id:this.labelId,label:this.label,hint:this.hint,required:this.required,class:"alc-autocomplete__field"},i("alc-popup",{key:"501e5c316ac6522c56bc99fcea728af6834074db",shift:true,flip:true,strategy:"fixed",active:a,distance:2,placement:"bottom-start",sync:"width"},i("div",{key:"fa18971d71a168c13fe5c5fc71d206b833e86a78",slot:"anchor"},i("alc-icon",{key:"fcbfbb27da3573b965782b1e6da72015dc9d6e23",name:"search",label:"Pesquisar",class:"alc-autocomplete__icon"}),i("input",Object.assign({key:"6ef5f5ca522b0c3da2703040410d49a0829c8771",ref:e=>this.input=e,placeholder:this.placeholder,class:"alc-autocomplete__input",type:"text",role:"combobox","aria-haspopup":"grid","aria-expanded":"false","aria-autocomplete":"list","aria-controls":this.gridId,id:this.inputId,disabled:this.disabled||this.loading,onInput:()=>this.handleInput()},r())),this.itemSelected&&((e=this.input)===null||e===void 0?void 0:e.value)&&i("button",Object.assign({key:"f72623e4729db617f4ae3060146c2d2c8647a5eb",type:"button",class:"alc-button alc-button-rounded alc-autocomplete__clear-button",onClick:e=>this.clearSelection(e)},r()),i("alc-icon",{key:"07f21c425fafc4a0009718a2109dbefac0b7ae08",name:"x-lg",label:"Limpar"}))),i("div",{key:"459d4e47aa9f6adbc3536e7df97d712cb8bd0ffe",class:"alc-autocomplete__container-results"},this.loading?i("div",{class:"alc-autocomplete__loading-indicator"},i("alc-icon",{name:"arrow-clockwise",label:"Carregando",class:"alc-autocomplete__loading-icon"})," Carregando..."):null,this.error?i("div",{class:"alc-autocomplete__has-an-error-indicator"},i("alc-icon",{name:"exclamation-triangle",label:"Erro",class:"mr-1"})," Serviço indisponível. Volte mais tarde!"):null,!this.error&&this.emptyResult?i("div",{class:"alc-autocomplete__has-an-error-indicator"},i("alc-icon",{name:"exclamation-triangle",label:"Erro",class:"mr-1"})," Nenhum resultado encontrado. Refine seus critérios de pesquisa."):null,i("div",Object.assign({key:"0c7746fe2febad6825ab31e0619eeb5bc67365d8",class:"alc-autocomplete__results"},r()),i("ul",{key:"863a18714395fc6ee3123dae27e11621f04107d1","aria-labelledby":this.labelId,role:"listbox",id:this.gridId,class:t,ref:e=>this.grid=e}),i("div",{key:"f9c1fc7eae956f6891382f2f678b447a162dd65e",id:this.messageRowContainerId,class:"alc-autocomplete__message-row-container"}))))))}get el(){return a(this)}static get watchers(){return{selectedItemValue:["selectedItemValueChanged"],loading:["handleLoadingChange"]}}};c.style=l;export{c as alc_autocomplete};
//# sourceMappingURL=p-5b381b49.entry.js.map