{"version":3,"names":["alcDrawerBaseCss","themeAlcDrawerCss","AlcDrawer","constructor","hostRef","this","triggerElement","elementToFocus","isVisible","getDrawerRef","element","drawerRef","handleFocusWhenCloseDrawer","document","getElementById","focus","defaultFocus","hasTriggerElement","body","contains","includes","tagName","watchIsVisible","lockBodyScroll","activeElement","show","unlockBodyScroll","hide","defaultPrevented","alcShow","emit","alcAfterShow","alcHide","alcAfterHide","handleKeyDown","event","key","preventDefault","focusableElements","getFocusableElements","componentDidRender","focusFirstElement","connectedCallback","disconnectedCallback","render","h","Host","style","display","class","role","ref","Object","assign","onClick","test","name","label"],"sources":["src/components/alc-drawer/alc-drawer-base.css?tag=alc-drawer&mode=base","src/components/alc-drawer/alc-drawer.css?tag=alc-drawer&mode=theme","src/components/alc-drawer/alc-drawer.tsx"],"sourcesContent":[".alc-modal__overlay {\n  @apply fixed inset-0 flex items-start justify-end z-10;\n}\n\n.alc-drawer__content {\n  @apply relative w-full max-w-md h-full overflow-y-auto;\n}\n\n.alc-drawer__header {\n  @apply flex justify-end p-4;\n}",".alc-drawer__overlay {\n  @apply fixed inset-0 flex items-start justify-end bg-opacity-40 bg-gray-cool-80 z-30;\n}\n\n.alc-drawer__content {\n  @apply relative w-full max-w-md bg-skin-surface-primary h-full overflow-y-auto shadow-lg;\n}\n\n.alc-drawer__header {\n  @apply block absolute right-0 pr-[--alc-spacing-04] pt-[--alc-spacing-04];\n}\n","import { Component, Host, h, Prop, Method, Listen, Event, EventEmitter, Watch } from '@stencil/core';\nimport { getFocusableElements, focusFirstElement, handleKeyDown } from '../utils/keydown';\nimport test from '../utils/testAttributes';\nimport { lockBodyScroll, unlockBodyScroll } from '../utils/scrollLockManager';\n@Component({\n  tag: 'alc-drawer',\n  styleUrls: {\n    base: 'alc-drawer-base.css',\n    theme: 'alc-drawer.css'\n  },\n  scoped: false,\n})\nexport class AlcDrawer {\n  private drawerRef?: HTMLElement;\n  private triggerElement = null;\n\n  /**\n  * @type Element ou ID\n  * @description Elemento ou ID do elemento que será focado quando o drawer fechar.\n  */\n  @Prop() elementToFocus?: HTMLElement | string = null;\n\n  /**\n  * @type boolean\n  * @description Define se o drawer está aberto ou fechado.\n  */\n  @Prop({ mutable: true, reflect: true }) isVisible?: boolean = false;\n\n  @Watch('isVisible')\n  watchIsVisible(isVisible: boolean) {\n    if (isVisible) {\n      lockBodyScroll();\n      this.triggerElement = document.activeElement as HTMLElement;\n      this.show();\n      return isVisible;\n    }\n\n    unlockBodyScroll();\n    this.hide();\n    return isVisible;\n  }\n\n  /**\n   * Evento disparado quando o drawer vai abrir\n   */\n  @Event({\n    eventName: 'alc-show',\n    cancelable: true,\n    bubbles: true\n  }) alcShow: EventEmitter<null>;\n\n  /**\n   * Evento disparado quando o drawer abriu\n   */\n  @Event({\n    eventName: 'alc-after-show',\n    cancelable: false,\n    bubbles: true\n  }) alcAfterShow: EventEmitter<null>;\n\n  /**\n  * Evento disparado quando o drawer vai fechar\n  */\n  @Event({\n    eventName: 'alc-hide',\n    cancelable: true,\n    bubbles: true\n  }) alcHide: EventEmitter<null>;\n\n  /**\n   * Evento disparado quando o drawer fechou\n   */\n  @Event({\n    eventName: 'alc-after-hide',\n    cancelable: false,\n    bubbles: true\n  }) alcAfterHide: EventEmitter<null>;\n\n  /**\n  * Método para abrir o drawer.\n  */\n  @Method()\n  async show(): Promise<boolean> {\n    if (this.isVisible) {\n      return false;\n    }\n\n    const { defaultPrevented } = this.alcShow.emit();\n    if (defaultPrevented) {\n      return false;\n    }\n\n    this.isVisible = true;\n    this.alcAfterShow.emit();\n\n    return true;\n  }\n\n  /**\n  * Método para fechar o drawer.\n  */\n  @Method()\n  async hide(): Promise<boolean> {\n    if (!this.isVisible) {\n      return false;\n    }\n\n    const { defaultPrevented } = this.alcHide.emit();\n    if (defaultPrevented) {\n      return false;\n    }\n\n    this.isVisible = false;\n    this.alcAfterHide.emit();\n\n    this.handleFocusWhenCloseDrawer();\n\n    return true;\n  }\n\n  /**\n  * Foco fica dentro do drawer quando aberta.\n  */\n  @Listen('keydown', { target: 'document' })\n  handleKeyDown(event: KeyboardEvent) {\n    if (!this.isVisible) {\n      return;\n    };\n\n    if (event.defaultPrevented) {\n      return;\n    }\n\n    if(event.key === 'Escape') {\n      event.preventDefault();\n      this.hide();\n      return;\n    }\n\n    if (event.key !== 'Tab') return;\n    const focusableElements = getFocusableElements(this.drawerRef);\n    handleKeyDown(event, focusableElements);\n  }\n\n  componentDidRender() {\n    // Pega os elementos focáveis a cada renderização (Pode haver mudanças no drawer).\n    const focusableElements = getFocusableElements(this.drawerRef);\n\n    // Após o componente renderizar e estiver aberto, então ja coloca foco dentro do drawer.\n    if (this.isVisible) {\n      focusFirstElement(focusableElements);\n    }\n\n  }\n\n  connectedCallback() {\n    if (this.isVisible) {\n      lockBodyScroll();\n    }\n  }\n\n  disconnectedCallback() {\n    if (this.isVisible) {\n      unlockBodyScroll();\n    }\n  }\n\n  private getDrawerRef = (element) => this.drawerRef = element as HTMLElement;\n\n  private handleFocusWhenCloseDrawer = () => {\n    if(!!this.elementToFocus) {\n      let element = this.elementToFocus;\n      if(typeof element === 'string') {\n        element = document.getElementById(element);\n      }\n      return !!element ? element.focus() : null;\n    }\n\n    const defaultFocus = ['BODY', 'DOCUMENT'];\n    const hasTriggerElement = !!this.triggerElement && document.body.contains(this.triggerElement);\n\n    if(hasTriggerElement && !defaultFocus.includes(this.triggerElement.tagName)){\n      this.triggerElement.focus();\n      return;\n    }\n\n    return;\n  }\n\n  render() {\n    return (\n      <Host style={{ display: this.isVisible ? 'block' : 'none' }}>\n        <div class=\"alc-drawer__overlay\">\n          <div\n            class=\"alc-drawer__content bg-white dark:bg-black\"\n            role=\"dialog\"\n            aria-modal=\"true\"\n            ref={this.getDrawerRef}\n          >\n            <div class=\"alc-drawer__header\">\n              <button\n                class=\"alc-button alc-button-rounded\"\n                onClick={() => this.hide()}\n                {...test('data-test-close-button')}\n              >\n                <alc-icon name=\"x-lg\" label=\"Fechar Drawer\" {...test('data-test-close-icon')} />\n              </button>\n            </div>\n            <div>\n              <slot></slot>\n            </div>\n          </div>\n        </div>\n      </Host>\n    );\n  }\n\n}\n"],"mappings":"qLAAA,MAAMA,EAAmB,8XCAzB,MAAMC,EAAoB,05B,MCYbC,EAAS,MARtB,WAAAC,CAAAC,G,wKAUUC,KAAcC,eAAG,KAMjBD,KAAcE,eAA0B,KAMRF,KAASG,UAAa,MA6ItDH,KAAYI,aAAIC,GAAYL,KAAKM,UAAYD,EAE7CL,KAA0BO,2BAAG,KACnC,KAAKP,KAAKE,eAAgB,CACxB,IAAIG,EAAUL,KAAKE,eACnB,UAAUG,IAAY,SAAU,CAC9BA,EAAUG,SAASC,eAAeJ,E,CAEpC,QAASA,EAAUA,EAAQK,QAAU,I,CAGvC,MAAMC,EAAe,CAAC,OAAQ,YAC9B,MAAMC,IAAsBZ,KAAKC,gBAAkBO,SAASK,KAAKC,SAASd,KAAKC,gBAE/E,GAAGW,IAAsBD,EAAaI,SAASf,KAAKC,eAAee,SAAS,CAC1EhB,KAAKC,eAAeS,QACpB,M,CAGF,OA+BH,CA5LC,cAAAO,CAAed,GACb,GAAIA,EAAW,CACbe,IACAlB,KAAKC,eAAiBO,SAASW,cAC/BnB,KAAKoB,OACL,OAAOjB,C,CAGTkB,IACArB,KAAKsB,OACL,OAAOnB,C,CA2CT,UAAMiB,GACJ,GAAIpB,KAAKG,UAAW,CAClB,OAAO,K,CAGT,MAAMoB,iBAAEA,GAAqBvB,KAAKwB,QAAQC,OAC1C,GAAIF,EAAkB,CACpB,OAAO,K,CAGTvB,KAAKG,UAAY,KACjBH,KAAK0B,aAAaD,OAElB,OAAO,I,CAOT,UAAMH,GACJ,IAAKtB,KAAKG,UAAW,CACnB,OAAO,K,CAGT,MAAMoB,iBAAEA,GAAqBvB,KAAK2B,QAAQF,OAC1C,GAAIF,EAAkB,CACpB,OAAO,K,CAGTvB,KAAKG,UAAY,MACjBH,KAAK4B,aAAaH,OAElBzB,KAAKO,6BAEL,OAAO,I,CAOT,aAAAsB,CAAcC,GACZ,IAAK9B,KAAKG,UAAW,CACnB,M,CAGF,GAAI2B,EAAMP,iBAAkB,CAC1B,M,CAGF,GAAGO,EAAMC,MAAQ,SAAU,CACzBD,EAAME,iBACNhC,KAAKsB,OACL,M,CAGF,GAAIQ,EAAMC,MAAQ,MAAO,OACzB,MAAME,EAAoBC,EAAqBlC,KAAKM,WACpDuB,EAAcC,EAAOG,E,CAGvB,kBAAAE,GAEE,MAAMF,EAAoBC,EAAqBlC,KAAKM,WAGpD,GAAIN,KAAKG,UAAW,CAClBiC,EAAkBH,E,EAKtB,iBAAAI,GACE,GAAIrC,KAAKG,UAAW,CAClBe,G,EAIJ,oBAAAoB,GACE,GAAItC,KAAKG,UAAW,CAClBkB,G,EA0BJ,MAAAkB,GACE,OACEC,EAACC,EAAI,CAAAV,IAAA,2CAACW,MAAO,CAAEC,QAAS3C,KAAKG,UAAY,QAAU,SACjDqC,EAAK,OAAAT,IAAA,2CAAAa,MAAM,uBACTJ,EAAA,OAAAT,IAAA,2CACEa,MAAM,6CACNC,KAAK,SACM,oBACXC,IAAK9C,KAAKI,cAEVoC,EAAK,OAAAT,IAAA,2CAAAa,MAAM,sBACTJ,EAAA,SAAAO,OAAAC,OAAA,CAAAjB,IAAA,2CACEa,MAAM,gCACNK,QAAS,IAAMjD,KAAKsB,QAChB4B,KAEJV,EAAA,WAAAO,OAAAC,OAAA,CAAAjB,IAAA,2CAAUoB,KAAK,OAAOC,MAAM,iBAAoBF,QAGpDV,EAAA,OAAAT,IAAA,4CACES,EAAA,QAAAT,IAAA,gD","ignoreList":[]}