{"version":3,"names":["alcNavPanelCss","DEFAULT_STATE","open","TABLET_BREAKPOINT","Number","screens","md","split","DESKTOP_BREAKPOINT","lg","AlcNavPanel","exports","class_1","hostRef","this","state","display","getDisplay","offsetTop","prototype","show","updateState","hide","handleResize","newDisplay","htmlElementClassList","document","querySelector","classList","contains","remove","add","el","setOffset","handleClick","event","targetElement","target","handleKeyDown","defaultPrevented","key","preventDefault","button","focus","getFocusableElements","handleOpen","content","hidden","componentWillLoad","detail","alcStateRequest","emit","Object","assign","componentDidLoad","_this","addEventListener","handleTransitionEnd","bind","observer","MutationObserver","newOffsetTop","console","log","concat","observe","body","attributes","childList","subtree","disconnectedCallback","removeEventListener","disconnect","width","window","innerWidth","alcStateChange","style","setProperty","toString","renderButtonSVG","h","height","viewBox","fill","xmlns","d","class","render","Host","onClick","ref","name","label"],"sources":["src/components/alc-nav-panel/alc-nav-panel.css?tag=alc-nav-panel","src/components/alc-nav-panel/alc-nav-panel.tsx"],"sourcesContent":[":host {\n  display: block;\n}\n\n[data-alc-theme=\"light\"] alc-nav-panel {\n  --color-button: theme('colors.mint-cool.5');\n  --color-button-hover: theme('colors.mint-cool.10');\n\n  /* 26 indica 15% de transparencia */\n  --color-drop-shadow: theme('colors.black')26;\n  --outline-color: var(--alc-color-action-60);\n}\n\n[data-alc-theme=\"dark\"] alc-nav-panel {\n  --color-button: theme('colors.cyan.70');\n  --color-button-hover: theme('colors.cyan.60');\n\n  /* No modo dark ja tem contraste suficiente entre a borda e conteúdo,\n    por isso não precisa de sombra\n   */\n  --color-drop-shadow: theme('colors.transparent');\n  --outline-color: var(--alc-color-neutral-0);\n}\n\n\nalc-nav-panel {\n  --border-width: theme('borderWidth.8');\n\n  /* Largura padrão do conteúdo */\n  --content-width: 18rem;\n  \n  /* O valor default é 72px, que seria a altura padrão em produção do header, em situação \"normal\" */\n  --height: calc(var(--offset-top, 72) * 1px);\n\n  /*  Valor do conteudo + borda direita */\n  --max-width: calc(var(--content-width) + var(--border-width));\n}\n\n.alc-nav-panel {\n  /* Define a largura minima (tamanho da borda) para centralizar o conteúdo */\n  @apply md:min-w-[--border-width] transition-all z-50;\n}\n\n.alc-nav-panel--opened {\n  /* Aqui é definido a largura para empurrar o conteúdo a partir do lg */\n  @apply lg:min-w-[--max-width];\n}\n\n.alc-nav-panel__container {\n  @apply flex fixed flex-row-reverse;\n  /* Altura do viewpoint - o offsetTop do nav-panel */\n  height: calc(100vh - var(--height));\n}\n\n.alc-nav-panel__content {\n  @apply bg-[--alc-color-surface] h-full w-0 opacity-0 transition-all overflow-x-hidden block z-0;\n}\n\n.alc-nav-panel__content--opened {\n  @apply block w-[--content-width] opacity-100;\n}\n\n.alc-nav-panel__button-container {\n  @apply border-[--color-button] -z-0 text-[--alc-color-text-primary];\n  border-left-width: var(--border-width);\n  /* Drop-shadow para o sombreamento contornar o botão svg */\n  filter: drop-shadow(0 4px 3px var(--color-drop-shadow)) drop-shadow(0 2px 2px var(--color-drop-shadow));\n}\n\n.alc-nav-panel__button {\n  @apply relative mt-4 rounded -left-2 pl-2;\n}\n\n.alc-nav-panel__button:focus-visible {\n  @apply outline-none;\n}\n\n.alc-nav-panel__button:focus-visible .alc-nav-panel__button-icon {\n  @apply outline outline-2 outline-[--outline-color];\n}\n\n.alc-nav-panel__button-icon {\n  @apply absolute top-5 left-2;\n}\n\n.alc-nav-panel__button-svg {\n  @apply fill-[--color-button];\n}\n\n/* Tratamento da cor do svg + borda quando o botão recebe foco */\n.alc-nav-panel__button:hover .alc-nav-panel__button-svg {\n  @apply fill-[--color-button-hover] transition-colors;\n}\n\n.alc-nav-panel__button-container:has(.alc-nav-panel__button:hover) {\n  @apply border-[--color-button-hover] transition-colors;\n}\n/* ******* */\n.alc-nav-panel--hidden {\n  @apply hidden;\n}","import { Component, Host, Prop, h, Method, Event, EventEmitter, Element, State, Listen, Watch } from '@stencil/core';\nimport { getFocusableElements, handleKeyDown } from '../utils/keydown';\nimport screens from '../../../tailwind-screens';\n\nexport interface AlcStateEventTypes {\n  state: {\n    open: boolean;\n  }\n}\n\nconst DEFAULT_STATE = {\n  open: true\n};\n\n// Pega o valor definido da configuração do tailwind e remove o 'px'\nconst TABLET_BREAKPOINT = Number(screens.md.split('px')[0]);\nconst DESKTOP_BREAKPOINT = Number(screens.lg.split('px')[0]);\n\n/**\n * @slot DEFAULT - Slot para o conteúdo do nav-panel.\n */\n\n@Component({\n  tag: 'alc-nav-panel',\n  styleUrl: 'alc-nav-panel.css',\n  shadow: false\n})\nexport class AlcNavPanel {\n  @Element() el: HTMLAlcNavPanelElement;\n\n  private content: HTMLDivElement;\n  private button: HTMLButtonElement;\n  private state: {\n    open: boolean,\n  } = DEFAULT_STATE;\n  private display: 'mobile' | 'tablet' | 'desktop' = this.getDisplay();\n  private observer: MutationObserver;\n  private offsetTop: number = 0;\n\n  /**\n   * Indica se o nav-panel está visível. O valor inicial desse atributo será definido dinamicamente pelo próprio nav-panel.\n   */\n  @Prop({\n    reflect: true,\n    mutable: true\n  })\n  open: boolean;\n\n  /**\n   * Evento disparado quando o estado do nav-panel é alterado.\n   */\n  @Event({\n    eventName: 'alc-state-change',\n    cancelable: false,\n    bubbles: true\n  }) alcStateChange: EventEmitter<AlcStateEventTypes>;\n\n  /**\n   * Evento disparado quando o nav-panel precisa recuperar o estado.\n   */\n  @Event({\n    eventName: 'alc-state-request',\n    cancelable: false,\n    bubbles: true\n  }) alcStateRequest: EventEmitter<AlcStateEventTypes>;\n\n  /**\n   * Abre o nav-panel.\n   * @returns O valor retornado é `true` se o nav-panel foi exibido com a chamada do método.\n   */\n  @Method()\n  async show(): Promise<boolean> {\n    this.updateState(true);\n    return true;\n  }\n\n  /**\n   * Fecha o nav-panel.\n   * @returns O valor retornado é `true` se o nav-panel foi fechado com a chamada do método.\n   */\n  @Method()\n  async hide(): Promise<boolean> {\n    this.updateState(false);\n    return true;\n  }\n\n  @Listen('resize', { target: 'window' })\n  handleResize() {\n    // Atualiza o display se teve mudanças\n    const newDisplay = this.getDisplay();\n    if (newDisplay !== this.display) {\n      this.display = newDisplay;\n    }\n\n    // Essa classe é utilizada para aplicar padding e margins nas classes de container\n    // ATENÇÃO: Caso ocorra alteração no tamanho do botão ou da margin lateral, deve atualizar o tamanho dos paddings e margins\n    // na classe localizada em \"global/styles/c-layout.scss\"\n    const htmlElementClassList = document.querySelector('html').classList;\n\n    // Controle de CSS da tag html\n    if (newDisplay === 'mobile') {\n      // Se estiver no modo mobile e ter a classe alc-navpanel, remove a classe\n      htmlElementClassList.contains('alc-navpanel') ? htmlElementClassList.remove('alc-navpanel') : null;\n    } else {\n      // Se estiver no modo tablet ou desktop e NÃO ter a classe alc-navpanel, adiciona a classe\n      htmlElementClassList.contains('alc-navpanel') ? null: htmlElementClassList.add('alc-navpanel');\n    }\n\n    // Controle de exibição (open)\n    // Se estiver indo para desktop, o estado salvo define o valor de open\n    if (newDisplay === 'desktop') {\n      this.open = this.state.open;\n    }\n    // Senão, sempre estará oculto.\n    else {\n      this.open = false;\n    }\n\n    // Verifica se teve mudanças nos valores de offsetTop\n    // e atualiza as variáveis CSS\n    if (this.el.offsetTop !== this.offsetTop) {\n      this.setOffset(this.el.offsetTop);\n    }\n\n  }\n\n  @Listen('click', { target: 'body' })\n  handleClick(event: MouseEvent) {\n    // Se estiver fechado, não faz nada\n    if (!this.open) return;\n\n    // Se o elemento clicado é dentro do nav-panel ou um de seus filhos, não faz nada\n    const targetElement = event.target as HTMLElement;\n    if (this.el.contains(targetElement)) return;\n\n    // Se o breakpoint for desktop, não faz nada\n    if (this.display === 'desktop') return;\n\n    // Se o breakpoint for tamanho tablet ou menor, fecha o nav-panel ao clicar fora\n    this.hide();\n  }\n\n  @Listen('keydown')\n  handleKeyDown(event: KeyboardEvent) {\n    // Se estiver fechado, não faz nada\n    if (!this.open || event.defaultPrevented) return;\n\n    switch (event.key) {\n      // Se apertar \"Escape\", fecha o nav-panel\n      case 'Escape':\n        event.preventDefault();\n        this.hide();\n        this.button.focus();\n        break;\n      // Se o breakpoint for tamanho tablet ou menor, controla o foco dentro do nav-panel\n      case 'Tab':\n        if (this.display !== 'desktop') {\n          handleKeyDown(event, getFocusableElements(this.el));\n        }\n        break;\n    }\n  }\n\n  @Watch('open')\n  handleOpen() {\n    if (this.open && this.content) {\n      // Remove o atributo \"hidden\" quando o nav-panel é aberto\n      this.content.hidden = false;\n    }\n  }\n\n  componentWillLoad() {\n    // Monta objeto para o evento - Nesse momento, com o valor padrão.\n    const detail = {\n      state: DEFAULT_STATE\n    };\n    // Requisita o estado gravado\n    this.alcStateRequest.emit(detail); // Emite o evento para solicitar o estado\n    // Garante que o objeto this.state tenha as chaves esperadas, independente do valor de detail.state\n    // Grava o estado em memória\n    // O estado é sempre salvo, independentemente do valor de `display`, porque `display` pode\n    // mudar dinamicamente, e o estado pode passar a ser necessário.\n    this.state = { ...DEFAULT_STATE, ...detail.state };\n\n    if (this.display === 'desktop') {\n      // \"open\" para desktop será inicialmente o estado salvo\n      this.open = this.state.open;\n    }\n    else {\n      // \"open\" para outros cenários (não desktop) inicialmente será false.\n      this.open = false;\n    }\n  }\n\n  componentDidLoad() {\n    this.setOffset(this.el.offsetTop);\n\n    // Esconde o conteúdo quando o nav-panel é fechado após a transição\n    // A animação não funciona quando adiciona hidden no CSS\n    this.content.addEventListener(\"transitionend\", this.handleTransitionEnd.bind(this));\n\n    if (this.getDisplay() !== 'mobile') {\n      // Essa classe é utilizada para aplicar padding e margins nas classes de container\n      document.querySelector('html').classList.add('alc-navpanel');\n    }\n\n    this.observer = new MutationObserver(() => {\n      const newOffsetTop = this.el.offsetTop;\n      if (newOffsetTop !== this.offsetTop) {\n        console.log(`offsetTop mudou de ${this.offsetTop} para ${newOffsetTop}`);\n        this.setOffset(newOffsetTop);\n      }\n    });\n\n    // Observa mudanças no body inteiro, pois mudanças acima no DOM podem afetar o offsetTop\n    this.observer.observe(document.body, {\n      attributes: true,\n      childList: true,\n      subtree: true\n    });\n\n\n  }\n\n  disconnectedCallback() {\n    this.content.removeEventListener(\"transitionend\", this.handleTransitionEnd.bind(this));\n\n    if (this.observer) {\n      this.observer.disconnect();\n    }\n  }\n\n  private handleTransitionEnd() {\n    if (!this.open) {\n      this.content.hidden = true;\n    }\n  }\n\n  private getDisplay(): 'mobile' | 'tablet' | 'desktop' {\n    const width = window.innerWidth;\n\n    if (width >= DESKTOP_BREAKPOINT) return 'desktop';\n    if (width >= TABLET_BREAKPOINT) return 'tablet';\n    return 'mobile';\n  }\n\n  private updateState(open: boolean) {\n    this.open = open;\n\n    if (this.getDisplay() === 'desktop') {\n      this.state.open = open;\n      this.alcStateChange.emit({ state: this.state });\n    }\n  }\n\n  private setOffset(offsetTop?: number) {\n    this.offsetTop = offsetTop;\n    // Altura esta o elemento em relação ao topo da tela)\n    this.el.style.setProperty('--offset-top', this.el.offsetTop.toString());\n  }\n  // Utilizando \"svg\" diretamente em vez de uma tag <img> para permitir a personalização da cor do SVG no modo dark\n  private renderButtonSVG() {\n    return (\n      <svg width=\"24\" height=\"62\" viewBox=\"0 0 24 62\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\" >\n        <path d=\"M7 7C1.4 7 0 2.33333 0 0C0 20.6667 6.69364e-06 41.3333 0 62C0 59.6667 1.4 55 7 55H20C22.2091 55 24 53.2091 24 51V11C24 8.79086 22.2091 7 20 7H7Z\" fill=\"#e0f7f6\" class=\"alc-nav-panel__button-svg\" />\n      </svg>\n    )\n  }\n\n  render() {\n\n    return (\n      <Host\n        class={{\n          'alc-nav-panel': true,\n          'alc-nav-panel--opened': this.open\n        }}\n      >\n        <div class=\"alc-nav-panel__container\">\n          <div class=\"alc-nav-panel__button-container\">\n            <button\n              class=\"alc-nav-panel__button\"\n              onClick={() => this.open ? this.hide() : this.show()}\n              aria-pressed={this.open ? 'true' : 'false'}\n              aria-label=\"Exibir navegação\"\n              ref={el => this.button = el}\n              data-alc-navpanel-button\n            >\n              {this.renderButtonSVG()}\n              <alc-icon\n                class=\"alc-nav-panel__button-icon\"\n                name={this.open ? 'x-lg' : 'list'}\n                label=\"\"\n              ></alc-icon>\n            </button>\n          </div>\n          <div\n            class={{\n              'alc-nav-panel__content': true,\n              'alc-nav-panel__content--opened': this.open\n            }}\n            ref={el => this.content = el}\n          >\n            <slot></slot>\n          </div>\n        </div>\n      </Host>\n    );\n  }\n}\n"],"mappings":"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","ignoreList":[]}