import{h as c,H as b,a as w,r as y,b as _}from"./index-BAARPnTD.js";import{g as p}from"./getUniqueId-BY09qPiz-DUBCreeJ.js";import{t as f}from"./testAttributes-DKpd2q2s-wgqXZsRm.js";var m=function(l,e,t,o){function r(i){return i instanceof t?i:new t(function(s){s(i)})}return new(t||(t=Promise))(function(i,s){function u(d){try{a(o.next(d))}catch(h){s(h)}}function n(d){try{a(o.throw(d))}catch(h){s(h)}}function a(d){d.done?i(d.value):r(d.value).then(u,n)}a((o=o.apply(l,e||[])).next())})},v=function(l,e){var t={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},o,r,i,s;return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(a){return function(d){return n([a,d])}}function n(a){if(o)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(t=0)),t;)try{if(o=1,r&&(i=a[0]&2?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return t.label++,{value:a[1],done:!1};case 5:t.label++,r=a[1],a=[0];continue;case 7:a=t.ops.pop(),t.trys.pop();continue;default:if(i=t.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){t=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){t.label=a[1];break}if(a[0]===6&&t.label<i[1]){t.label=i[1],i=a;break}if(i&&t.label<i[2]){t.label=i[2],t.ops.push(a);break}i[2]&&t.ops.pop(),t.trys.pop();continue}a=e.call(l,t)}catch(d){a=[6,d],r=0}finally{o=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},x='[data-alc-theme="light"] alc-autocomplete{--bg-color:var(--alc-color-surface-primary);--bg-color-footer:var(--alc-color-layer-b);--bg-color-hover:var(--alc-color-layer-b);--border-color:var(--alc-color-neutral-60);--border-color-hover:var(--alc-color-action-60);--border-color-focus:var(--alc-color-action-20);--text-color:var(--alc-color-text-primary)}[data-alc-theme="dark"] alc-autocomplete{--bg-color:var(--alc-color-surface-primary);--bg-color-footer:var(--alc-color-layer-b);--bg-color-hover:var(--alc-color-layer-b);--border-color:var(--alc-color-neutral-60);--border-color-hover:var(--alc-color-action-60);--border-color-focus:var(--alc-color-action-20);--text-color:var(--alc-color-text-primary)}alc-autocomplete{display:block}.alc-autocomplete__grid.is-hidden{display:none}.alc-autocomplete__result-cell{line-height:1.5rem}.alc-autocomplete__grid{z-index:10;width:100%;min-width:16rem;border-width:1px;border-style:solid;border-color:var(--border-color);background-color:var(--bg-color);padding:0px}.alc-autocomplete__message-row-container{width:100%}.alc-autocomplete__result-row{display:-ms-flexbox;display:flex;cursor:default;padding:0.5rem}.alc-autocomplete__result-row:hover{background-color:var(--bg--color-hover);background-color:var(--bg-color-hover)}.alc-autocomplete__result-row.is-focused{border-radius:0.125rem;border-width:2px;border-style:solid;border-color:var(--border-color-hover);color:var(--text-color);-webkit-text-decoration-line:underline;text-decoration-line:underline}.alc-autocomplete__result-cell.is-focused{-webkit-text-decoration-line:underline;text-decoration-line:underline}.alc-autocomplete__result-cell{margin:0px;display:inline-block;cursor:default;padding-left:0.25rem;padding-right:0.25rem;font-size:1rem;line-height:1.5rem}.alc-autocomplete__result-cell:nth-child(n+2){font-size:0.75rem;font-weight:400;line-height:1.5rem;color:var(--text-color)}.alc-autocomplete__icon{pointer-events:none;position:absolute;left:0.5rem;top:0.5rem}.alc-field__input.alc-autocomplete__input{padding-left:2rem}.alc-autocomplete__clear-button{position:absolute;right:0.25rem;cursor:pointer}.alc-autocomplete__message-row{border-left-width:1px;border-right-width:1px;border-bottom-width:1px;border-style:solid;border-color:var(--border-color);background-color:var(--bg-color-footer);padding:0.5rem;font-style:italic;color:var(--text-color)}.alc-autocomplete__field .alc-field__core{position:relative}.alc-field__input.alc-autocomplete__input{text-overflow:ellipsis;padding-left:2rem;padding-right:3rem}.alc-autocomplete__result-row--horizontal{-ms-flex-direction:row;flex-direction:row}.alc-autocomplete__result-row--vertical{-ms-flex-direction:column;flex-direction:column}.alc-autocomplete__grid--vertical{max-height:100%;overflow-y:scroll}.alc-autocomplete__list-container{position:absolute;z-index:10;margin-top:2.75rem;width:100%;min-width:250px}.alc-autocomplete__has-an-error-indicator,.alc-autocomplete__loading-indicator{margin-bottom:-0.25rem;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;border-width:1px;border-style:solid;border-color:var(--border-color);background-color:var(--bg-color-footer);padding:0.5rem;font-family:#000}.alc-autocomplete__loading-icon{margin-right:0.25rem}@-webkit-keyframes spin{to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spin{to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}.alc-autocomplete__loading-icon{-webkit-animation:spin 1s linear infinite;animation:spin 1s linear infinite}.alc-autocomplete__loading-icon .icon-inner{display:block}.alc-autocomplete__loading-icon .alc-icon__image{top:0px;margin-top:0px;height:auto;width:auto}.alc-autocomplete__container-results{height:100%;max-height:inherit}.alc-autocomplete__results{display:-ms-flexbox;display:flex;height:100%;max-height:inherit;-ms-flex-direction:column;flex-direction:column}',I=function(){function l(e){y(this,e),this.alcChange=_(this,"alc-change",7),this.items=[],this.displayKeys="",this.label="",this.hint="",this.required=!1,this.listDirection="vertical",this.disabled=!1,this.loading=!1,this.error=!1,this.errorMsg=null,this.filteredData=[],this.itemSelected=!1,this.selectedItemValue=null,this.emptyResult=!1,this.activeRowIndex=-1,this.activeColIndex=0,this.rowsCount=0,this.colsCount=0,this.gridFocused=!1,this.shown=!1,this.selectionCol=0}return l.prototype.selectedItemValueChanged=function(e){this.alcChange.emit(e)},l.prototype.handleLoadingChange=function(e,t){var o=this;t===!0&&e===!1&&!this.disabled&&this.input&&requestAnimationFrame(function(){o.input.focus()})},l.prototype.componentWillLoad=function(){this.inputId=p(),this.gridId=p(),this.labelId=p(),this.messageRowContainerId=p()},l.prototype.componentDidLoad=function(){var e=this,t=new MutationObserver(function(){e.input.hasAttribute("disabled")||(e.disabled||e.loading)&&e.input.setAttribute("disabled","true")});t.observe(this.input,{attributes:!0,attributeFilter:["disabled"]}),(this.disabled||this.loading)&&this.input.setAttribute("disabled","true"),this.input.addEventListener("focus",this.handleFocus.bind(this))},l.prototype.handleBodyClick=function(e){var t=e.target;t===this.input||t instanceof Node&&this.grid.contains(t)||this.hideResults()},l.prototype.handleInputKeyUp=function(e){var t=e.target;if(!(!(t instanceof Node)||!this.input.contains(t))){var o=e.key;switch(o){case"ArrowUp":case"ArrowDown":case"Escape":case"Enter":e.preventDefault();return;case"ArrowLeft":case"ArrowRight":if(this.gridFocused){e.preventDefault();return}break;default:this.updateResults()}}},l.prototype.handleInputKeyDown=function(e){var t=this,o=e.key,r=this.activeRowIndex,i=this.activeColIndex,s=e.target;if(!(!(s instanceof Node)||!this.input.contains(s))){if(o==="Escape"){e.preventDefault(),this.gridFocused?(this.gridFocused=!1,this.removeFocusCell(this.activeRowIndex,this.activeColIndex),this.activeRowIndex=-1,this.activeColIndex=0,this.input.setAttribute("aria-activedescendant","")):this.shown||setTimeout(function(){t.input.value=""},1),this.shown&&this.hideResults(),this.itemSelected=!1,this.emptyResult=!1,this.error=!1;return}if(!(this.rowsCount<1)){var u=this.getItemAt(r,this.selectionCol),n;switch(o){case"ArrowUp":this.gridFocused=!0,r=this.getRowIndex("ArrowUp"),e.preventDefault();break;case"ArrowDown":this.gridFocused=!0,r=this.getRowIndex("ArrowDown"),e.preventDefault();break;case"ArrowLeft":i<=0?(i=this.colsCount-1,r=this.getRowIndex("ArrowLeft")):i--,this.gridFocused&&e.preventDefault();break;case"ArrowRight":i===-1||i>=this.colsCount-1?(i=0,r=this.getRowIndex("ArrowRight")):i++,this.gridFocused&&e.preventDefault();break;case"Enter":e.preventDefault(),this.gridFocused?(n=this.getItemAt(r,this.selectionCol),this.selectItem(n,e),this.gridFocused=!1):this.hideResults();return;case"Tab":this.hideResults();return;default:return}u&&this.removeFocusCell(this.activeRowIndex,this.activeColIndex),n=this.getItemAt(r,i),this.activeRowIndex=r,this.activeColIndex=i,n?(this.input.setAttribute("aria-activedescendant","result-item-"+r+"x"+i),this.focusCell(r,i)):this.input.setAttribute("aria-activedescendant","")}}},l.prototype.handleGridClick=function(e){var t=e.target;if(!(!t||!this.grid.contains(t))){var o=t.closest("li");if(o){var r=o.querySelector(".alc-autocomplete__result-cell");this.selectItem(r,e)}}},l.prototype.isElementInView=function(e){var t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)},l.prototype.updateResults=function(){var e=this.input.value;if(this.emptyResult=!1,e.length<2){this.hideResults(),this.emptyResult=!1;return}if(this.filteredData=this.searchDataService(e),this.hideResults(),this.filteredData.length>0){var t=10,o=this.filteredData.slice(0,t);if(o.length){for(var r=function(u){var n=document.createElement("li");n.className="alc-autocomplete__result-row alc-autocomplete__result-row--".concat(i.listDirection),n.setAttribute("role","option"),n.setAttribute("id","result-row-"+u),n.setAttribute("data-index",u.toString()),i.displayKeys.split(",").forEach(function(a,d){var h=document.createElement("span");h.className="alc-autocomplete__result-cell",h.setAttribute("role","presentation"),h.setAttribute("id","result-item-"+u+"x"+d),h.innerText=o[u][a.trim()],n.appendChild(h)}),i.grid.appendChild(n)},i=this,s=0;s<o.length;s++)r(s);this.grid.classList.remove("is-hidden"),this.input.setAttribute("aria-expanded","true"),this.rowsCount=o.length,this.colsCount=this.displayKeys.split(",").length,this.shown=!0}this.filteredData.length>t&&this.showMessageRow("Mais de 10 itens encontrados. Refine seus critérios de pesquisa.")}else this.emptyResult=!0},l.prototype.getRowIndex=function(e){var t=this.activeRowIndex;switch(e){case"ArrowUp":case"ArrowLeft":t<=0?t=this.rowsCount-1:t--;break;case"ArrowDown":case"ArrowRight":t===-1||t>=this.rowsCount-1?t=0:t++}return t},l.prototype.getItemAt=function(e,t){return document.getElementById("result-item-"+e+"x"+t)},l.prototype.selectItem=function(e,t){if(t&&t.preventDefault(),e){var o=e.closest("li"),r=o==null?void 0:o.getAttribute("data-index");if(r!=null){var i=this.filteredData[parseInt(r,10)];this.input.value=e.innerText,this.selectedItemValue=i,this.hideResults(),this.input.setAttribute("aria-expanded","false"),this.itemSelected=!0,this.emptyResult=!1,this.input.focus()}}},l.prototype.handleInput=function(){var e;this.itemSelected=((e=this.input)===null||e===void 0?void 0:e.value.length)>0},l.prototype.handleFocus=function(){var e=this.input.value||"";e.length>=2&&this.updateResults()},l.prototype.clearSelection=function(e){e.preventDefault(),this.clearSelected(),this.input.focus()},l.prototype.hideResults=function(){if(this.shown){this.gridFocused=!1,this.shown=!1,this.activeRowIndex=-1,this.activeColIndex=0,this.grid.innerHTML="",this.grid.classList.add("is-hidden"),this.input.setAttribute("aria-expanded","false"),this.rowsCount=0,this.colsCount=0,this.input.setAttribute("aria-activedescendant","");var e=this.el.querySelector("#".concat(this.messageRowContainerId));e&&(e.innerHTML=""),this.isElementInView(this.input)||this.input.scrollIntoView({behavior:"smooth",block:"nearest"})}},l.prototype.removeFocusCell=function(e,t){var o=document.getElementById("result-row-"+e);o&&(o.classList.remove("is-focused"),o.ariaSelected="false");var r=this.getItemAt(e,t);r&&r.classList.remove("is-focused")},l.prototype.focusCell=function(e,t){var o=document.getElementById("result-row-"+e);o&&(o.classList.add("is-focused"),o.ariaSelected="true");var r=this.getItemAt(e,t);r&&(r.classList.add("is-focused"),this.listDirection==="vertical"?this.ensureCellInView(r):this.isElementInView(r)||r.scrollIntoView({behavior:"smooth",block:"nearest"}))},l.prototype.ensureCellInView=function(e){var t=this.grid,o=e.offsetTop;t.scrollTop=o},l.prototype.searchDataService=function(e){for(var t=function(g){return g.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase()},o=t(e),r=[],i=0,s=this.items;i<s.length;i++)for(var u=s[i],n=0,a=this.displayKeys.split(",");n<a.length;n++){var d=a[n],h=t(u[d.trim()]||"");if(h.includes(o)){r.push(u);break}}return r},l.prototype.showMessageRow=function(e){var t=this.el.querySelector("#".concat(this.messageRowContainerId," ")),o=t.querySelector(".alc-autocomplete__message-row");if(!o){var r=document.createElement("div");r.className="alc-autocomplete__message-row",r.innerText=e,t&&t.appendChild(r)}},l.prototype.getSelected=function(){return m(this,void 0,void 0,function(){return v(this,function(e){return[2,this.selectedItemValue||null]})})},l.prototype.setSelected=function(e){return m(this,void 0,void 0,function(){var t,o;return v(this,function(r){return e&&(this.selectedItemValue=e,t=this.displayKeys.split(",")[0].trim(),o=e[t],this.input.value=o,this.itemSelected=!0,this.emptyResult=!1),[2]})})},l.prototype.clearSelected=function(){return m(this,void 0,void 0,function(){return v(this,function(e){return this.input.value="",this.selectedItemValue=null,this.itemSelected=!1,this.hideResults(),this.emptyResult=!1,this.error=!1,[2]})})},l.prototype.render=function(){var e=this,t,o=this.listDirection==="vertical"?"alc-autocomplete__grid alc-autocomplete__grid--vertical is-hidden alc-field__text":"alc-autocomplete__grid is-hidden alc-field__text",r=this.shown||this.loading||this.error||!this.error&&this.emptyResult;return c(b,{key:"d05e40ab10e25b249643fd2a7533183d38a484e2"},c("alc-field",{key:"afbffba276a97c5e4113615196aa94358af8ddbd",id:this.labelId,label:this.label,hint:this.hint,required:this.required,class:"alc-autocomplete__field"},c("alc-popup",{key:"501e5c316ac6522c56bc99fcea728af6834074db",shift:!0,flip:!0,strategy:"fixed",active:r,distance:2,placement:"bottom-start",sync:"width"},c("div",{key:"fa18971d71a168c13fe5c5fc71d206b833e86a78",slot:"anchor"},c("alc-icon",{key:"fcbfbb27da3573b965782b1e6da72015dc9d6e23",name:"search",label:"Pesquisar",class:"alc-autocomplete__icon"}),c("input",Object.assign({key:"6ef5f5ca522b0c3da2703040410d49a0829c8771",ref:function(i){return e.input=i},placeholder:this.placeholder,class:"alc-autocomplete__input",type:"text",role:"combobox","aria-haspopup":"grid","aria-expanded":"false","aria-autocomplete":"list","aria-controls":this.gridId,id:this.inputId,disabled:this.disabled||this.loading,onInput:function(){return e.handleInput()}},f())),this.itemSelected&&((t=this.input)===null||t===void 0?void 0:t.value)&&c("button",Object.assign({key:"f72623e4729db617f4ae3060146c2d2c8647a5eb",type:"button",class:"alc-button alc-button-rounded alc-autocomplete__clear-button",onClick:function(i){return e.clearSelection(i)}},f()),c("alc-icon",{key:"07f21c425fafc4a0009718a2109dbefac0b7ae08",name:"x-lg",label:"Limpar"}))),c("div",{key:"459d4e47aa9f6adbc3536e7df97d712cb8bd0ffe",class:"alc-autocomplete__container-results"},this.loading?c("div",{class:"alc-autocomplete__loading-indicator"},c("alc-icon",{name:"arrow-clockwise",label:"Carregando",class:"alc-autocomplete__loading-icon"})," Carregando..."):null,this.error?c("div",{class:"alc-autocomplete__has-an-error-indicator"},c("alc-icon",{name:"exclamation-triangle",label:"Erro",class:"mr-1"})," Serviço indisponível. Volte mais tarde!"):null,!this.error&&this.emptyResult?c("div",{class:"alc-autocomplete__has-an-error-indicator"},c("alc-icon",{name:"exclamation-triangle",label:"Erro",class:"mr-1"})," Nenhum resultado encontrado. Refine seus critérios de pesquisa."):null,c("div",Object.assign({key:"0c7746fe2febad6825ab31e0619eeb5bc67365d8",class:"alc-autocomplete__results"},f()),c("ul",{key:"863a18714395fc6ee3123dae27e11621f04107d1","aria-labelledby":this.labelId,role:"listbox",id:this.gridId,class:o,ref:function(i){return e.grid=i}}),c("div",{key:"f9c1fc7eae956f6891382f2f678b447a162dd65e",id:this.messageRowContainerId,class:"alc-autocomplete__message-row-container"}))))))},Object.defineProperty(l.prototype,"el",{get:function(){return w(this)},enumerable:!1,configurable:!0}),Object.defineProperty(l,"watchers",{get:function(){return{selectedItemValue:["selectedItemValueChanged"],loading:["handleLoadingChange"]}},enumerable:!1,configurable:!0}),l}();I.style=x;export{I as alc_autocomplete};
